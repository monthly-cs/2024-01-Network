<src img="https://github.com/monthly-cs/2024-01-network/assets/105256335/da93685f-cb81-482a-a922-410f3b561684">

### 3.5 ARP(Address Resolution Protocol)

---

2계층의 MAC 주소와 3 계층의 IP 주소를 통해 목적지를 찾아가지만, 사실

MAC 주소와 IP 주소간의 상관관계는 존재하지 않는다.

MAC 주소를 알아내기 위해 사용하는 프로토콜이 바로 ARP다.

IP주소와 MAC 주소간 상관관계가 없기 때문에 두 주소를 연결시켜주는 매커니즘이 필요한데 이 때 사용되는 것이 ARP다.

ARP가 특정한 무언가를 위해서만 동작한다기 보다는 물리주소와 논리주소를 연결할 때 사용한다.

패킷은 한번에 보낼 수 있는 양이 정해져 있기 때문에, 패킷을 잘라보내게 되는데 잘라보낼 때마다 ARP 브로드캐스트를 수행하면 네트워크 효율이 떨어지게 된다. 그래서 보통 ARP 브로드캐스트 정보를 메모리에 저장해두고 다시 사용한다.

시간이 지나면 이러한 정보는 삭제된다.

ARP는 내가 통신해야 할 상대방의 MAC 주소를 모를 때 ARP 브로드캐스트로 상대방의 IP 주소로 MAC 주소를 물어볼 목적으로 만들어진 프로토콜이다.

### 3.6 서브넷과 게이트웨이

---

초기에는 LAN(로컬 네트워크)가 중요했지만, 이제는 원격지와의 통신이 중요해 졌다.

원격지 네트워크와의 통신에 사용하는 장비를 게이트웨이라고 부르고 3계층 장비가 이 역할을 할 수 있다.

로컬 네트워크에서는 ARP 브로드캐스트를 통해 도착지 MAC 주소를 학습할 수 있고,

이 MAC 주소를 이용해 직접 통신할 수 있지만 원격 네트워크 통신은 네트워크를 넘어 전달되지 못하는 브로드캐스트의 성질 때문에 네트워크 장비인 게이트웨이의 도움이 필요하다.

네트워크 간 서로 다른 네트워크의 통신을 구분하기 위해 사용되는 것이 서브넷 마스크다.

서브넷 마스크 연산 결과값을 통해 로컬 통신과 원격지 통신을 구분한다.

로컬 네트워크에서 직접 통신할 경우 라우터와 같은 3계층 장비의 도움 없이도 통신할 수 있다.

일반적으로 MAC 주소인 물리적 주소만으로 통신할 수 있다면 2계층 통신이고,

라우터가 필요하며 원격지 통신을 할 경우 3계층 정보(IP)까지 확인해야 한다면 3계층 통신으로 본다.

 

결론적으로, 2계층 통신은 상대방의 MAC 주소를 알아내기 위해 ARP 브로드캐스트를 이용하고 상대방의 MAC 주소를 알아내고 패킷이 캡슐화되면서 통신이 시작되고

외부 네트워크가 필요하여 자신이 직접 요청을 보낼 수 없다거 판단하고 ARP 요청을 기본 게이트웨이 IP주소로 요청하면 3계층 통신이다.
